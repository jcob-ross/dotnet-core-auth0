webpackJsonp([0],{0:function(t,e,r){"use strict";var n=r(1),o=r(111),i=r(328),s=r(349),a=r(350),u=r(413),c=r(403);n.enableProdMode(),o.bootstrap(a.AppComponent,[i.HTTP_PROVIDERS,u.APP_ROUTER_PROVIDERS,c.AuthService,s.AUTH_PROVIDERS])["catch"](function(t){return console.error(t)})},349:function(t,e,r){"use strict";function n(t,e){void 0===t&&(t="id_token");var r=e||localStorage.getItem(t),n=new p;return r&&!n.isTokenExpired(r,null)}var o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=r(1),a=r(328),u=r(34),c=function(){function t(t){var e=this;void 0===t&&(t={}),this.headerName=t.headerName||"Authorization",t.headerPrefix?this.headerPrefix=t.headerPrefix+" ":t.noTokenScheme?this.headerPrefix="":this.headerPrefix="Bearer ",this.tokenName=t.tokenName||"id_token",this.noJwtError=t.noJwtError||!1,this.tokenGetter=t.tokenGetter||function(){return localStorage.getItem(e.tokenName)},this.globalHeaders=t.globalHeaders||[],this.noTokenScheme=t.noTokenScheme||!1}return t.prototype.getConfig=function(){return{headerName:this.headerName,headerPrefix:this.headerPrefix,tokenName:this.tokenName,tokenGetter:this.tokenGetter,noJwtError:this.noJwtError,noTokenScheme:this.noTokenScheme,globalHeaders:this.globalHeaders}},t}();e.AuthConfig=c;var l=function(){function t(t,e){var r=this;this.http=e,this._config=t.getConfig(),this.tokenStream=new u.Observable(function(t){t.next(r._config.tokenGetter())})}return t.prototype.setGlobalHeaders=function(t,e){t.forEach(function(t){var r=Object.keys(t)[0],n=t[r];e.headers.set(r,n)})},t.prototype.request=function(t,e){var r,o=this._config.globalHeaders;if(n(null,this._config.tokenGetter()))if("string"==typeof t){var i=e||{};i.headers||(i.headers=new a.Headers),o&&this.setGlobalHeaders(o,i),i.headers.set(this._config.headerName,this._config.headerPrefix+this._config.tokenGetter()),r=this.http.request(t,i)}else{var s=t;s.headers||(s.headers=new a.Headers),o&&this.setGlobalHeaders(o,s),s.headers.set(this._config.headerName,this._config.headerPrefix+this._config.tokenGetter()),r=this.http.request(s)}else{if(!this._config.noJwtError)return new u.Observable(function(t){t.error(new Error("No JWT present"))});r=this.http.request(t,e)}return r},t.prototype.requestHelper=function(t,e){var r=new a.RequestOptions(t);return e&&(r=r.merge(e)),this.request(new a.Request(r))},t.prototype.get=function(t,e){return this.requestHelper({url:t,method:a.RequestMethod.Get},e)},t.prototype.post=function(t,e,r){return this.requestHelper({url:t,body:e,method:a.RequestMethod.Post},r)},t.prototype.put=function(t,e,r){return this.requestHelper({url:t,body:e,method:a.RequestMethod.Put},r)},t.prototype["delete"]=function(t,e){return this.requestHelper({url:t,method:a.RequestMethod.Delete},e)},t.prototype.patch=function(t,e,r){return this.requestHelper({url:t,body:e,method:a.RequestMethod.Patch},r)},t.prototype.head=function(t,e){return this.requestHelper({url:t,method:a.RequestMethod.Head},e)},t=o([s.Injectable(),i("design:paramtypes",[c,a.Http])],t)}();e.AuthHttp=l;var p=function(){function t(){}return t.prototype.urlBase64Decode=function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}return decodeURIComponent(escape(window.atob(e)))},t.prototype.decodeToken=function(t){var e=t.split(".");if(3!==e.length)throw new Error("JWT must have 3 parts");var r=this.urlBase64Decode(e[1]);if(!r)throw new Error("Cannot decode the token");return JSON.parse(r)},t.prototype.getTokenExpirationDate=function(t){var e;if(e=this.decodeToken(t),"undefined"==typeof e.exp)return null;var r=new Date(0);return r.setUTCSeconds(e.exp),r},t.prototype.isTokenExpired=function(t,e){var r=this.getTokenExpirationDate(t);return e=e||0,null!==r&&!(r.valueOf()>(new Date).valueOf()+1e3*e)},t}();e.JwtHelper=p,e.tokenNotExpired=n,e.AUTH_PROVIDERS=[s.provide(l,{useFactory:function(t){return new l(new c,t)},deps:[a.Http]})]},350:function(t,e,r){"use strict";var n=r(1),o=r(351),i=r(403);r(407);var s=function(){function t(t,e,r){this.router=t,this.api=e,this.auth=r,this.url="https://github.com/jcob-ross/dotnet-core-auth0",this.urlText="â™¡ Angular 2 ASP.NET core with Auth0",this.userName=null,this.userPictureUrl=null}return t.prototype.ngOnInit=function(){this.getUserData()},t.prototype.isLoggedIn=function(){return this.auth.isLoggedIn},t.prototype.onLogInClick=function(){var t=this;this.auth.login().then(function(e){t.userName=e.name,t.userPictureUrl=e.hasPicture?e.pictureUrl:null},function(e){t.clearUserData()})},t.prototype.onLogOutClick=function(){this.auth.logout(),this.clearUserData()},t.prototype.clearUserData=function(){this.userName=null,this.userPictureUrl=null,this.router.navigate(["/"])},t.prototype.getUserData=function(){this.auth.isLoggedIn&&(this.userName=this.auth.currentUser.name,this.userPictureUrl=this.auth.currentUser.hasPicture?this.auth.currentUser.pictureUrl:null)},t=__decorate([n.Component({selector:"my-app",providers:[i.ApiService,i.AuthService],directives:o.ROUTER_DIRECTIVES.slice(),template:r(411),styles:[r(412)]}),__metadata("design:paramtypes",[o.Router,i.ApiService,i.AuthService])],t)}();e.AppComponent=s},403:function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}n(r(404)),n(r(405)),n(r(406))},404:function(t,e,r){"use strict";var n=r(1),o=r(328),i=r(349),s="http://localhost:8080/api/",a=function(){function t(t,e){this.http=t,this.secureHttp=e,this.title="Angular 2"}return t.prototype.ping=function(){return this.http.get(s+"ping")},t.prototype.securePing=function(){return this.secureHttp.get(s+"secured-ping")},t.prototype.ownerOnlyPing=function(){return this.secureHttp.get(s+"owner-only")},t.prototype.getUserData=function(){return this.secureHttp.get(s+"user-data")},t=__decorate([n.Injectable(),__metadata("design:paramtypes",[o.Http,i.AuthHttp])],t)}();e.ApiService=a},405:function(t,e,r){"use strict";var n=r(1),o=r(328),i=r(349),s=r(406),a={domain:"jcob-ross.eu.auth0.com",clientId:"EG9x8DKRALQKL3rDGYloT7uZCj6ku3bb",lockOptions:{responseType:"token",authParams:{state:"foo bar state",scope:"openid nickname email"}}},u=function(){function t(t){this.http=t,this._lock=new Auth0Lock(a.clientId,a.domain),this._jwtHelper=new i.JwtHelper,this._user=null,this.restoreSession()}return t.prototype.login=function(){var t=this;return new Promise(function(e,r){t._lock.show(a.lockOptions,function(n,o,i,s,a){t.lockCallback(e,r,n,o,i,s,a)})})},t.prototype.logout=function(){this.clearUserData()},Object.defineProperty(t.prototype,"isLoggedIn",{get:function(){return null!=this._user},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUser",{get:function(){return this._user},enumerable:!0,configurable:!0}),t.prototype.lockCallback=function(t,e,r,n,o,i,a){if(null!=r)return console.error("login failed with errors",r),this.clearUserData(),void e("login failed with errors");var u=this._jwtHelper.decodeToken(o),c=null;n.picture&&n.picture.length>0&&(c=n.picture);var l=new s.User(u.nickname,u.email,c);this._user=l,localStorage.setItem("id_token",o),localStorage.setItem("access_token",i);var p=JSON.stringify(l),h=window.btoa(encodeURIComponent(p));localStorage.setItem("user",h),t(l)},t.prototype.restoreSession=function(){var t=localStorage.getItem("user");if(!t||!localStorage.getItem("id_token"))return void this.clearUserData();if(this._jwtHelper.isTokenExpired(localStorage.getItem("id_token")))return void this.clearUserData();var e=JSON.parse(this.decode(t));this._user=new s.User(e._name,e._email,e._pictureUrl)},t.prototype.clearUserData=function(){this._user=null,localStorage.removeItem("id_token"),localStorage.removeItem("access_token"),localStorage.removeItem("user")},t.prototype.decode=function(t){return decodeURIComponent(window.atob(t))},t=__decorate([n.Injectable(),__metadata("design:paramtypes",[o.Http])],t)}();e.AuthService=u},406:function(t,e){"use strict";var r=function(){function t(t,e,r){this._name=t,this._email=e,this._pictureUrl=r}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"email",{get:function(){return this._email},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pictureUrl",{get:function(){return this._pictureUrl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPicture",{get:function(){return null!=this._pictureUrl},enumerable:!0,configurable:!0}),t}();e.User=r},407:function(t,e){},411:function(t,e){t.exports='<header>\r\n  <nav>\r\n    <a [routerLink]="[\'/\']">Home</a>\r\n    <a [routerLink]="[\'/about\']">About</a>\r\n    <span class="login-container pull-right">\r\n      <span *ngIf="userPictureUrl != null">\r\n        <img class="login-avatar" [src]="userPictureUrl" alt="user avatar">\r\n      </span>\r\n      <a *ngIf="!isLoggedIn()" (click)="onLogInClick()">Login</a>\r\n      <a *ngIf="isLoggedIn()" [routerLink]="[\'profile\']">{{ userName }}</a>\r\n      <a *ngIf="isLoggedIn()" class="logout-button" (click)="onLogOutClick()">LogOut</a>  \r\n    </span>    \r\n  </nav>\r\n</header>\r\n<main>\r\n  <h1 class="title">Hello from {{api.title}}!</h1>\r\n\r\n  <!-- Images (and assets) are parsed and loaded from within the public directory -->\r\n  <img src="/img/angular.png">\r\n\r\n  <router-outlet></router-outlet>\r\n</main>\r\n<footer>\r\n  <a [href]="url" target="_blank">{{ urlText }}</a>\r\n</footer>\r\n'},412:function(t,e){t.exports=":host{display:block}a{font-family:Arial, Helvetica, sans-serif;text-decoration:none}a:hover{cursor:pointer}header{background-color:#fff;padding:16px;position:fixed;top:0;left:0;width:100%;box-shadow:2px 2px 6px rgba(0,0,0,0.5)}main{padding:1em;font-family:Arial, Helvetica, sans-serif;text-align:center;margin-top:50px;display:block}footer{text-align:center;font-size:0.8em}nav{position:relative}.login-container .logout-button{transition:color 50ms ease-in-out, background-color 100ms ease-in-out;color:rgba(0,0,0,0.5);padding:4px}.login-container .logout-button:hover{color:white;background-color:darkgray;border-radius:8%}.login-container .login-avatar{border-radius:50%;width:40px;position:absolute;left:-50px;top:-50%;box-shadow:1px 3px 7px 0px rgba(0,0,0,0.2)}.pull-right{position:absolute;right:5%}\n"},413:function(t,e,r){"use strict";var n=r(351),o=r(1),i=r(34);r(414);var s=r(415),a=r(419),u=r(423),c=r(403),l=function(){function t(t){this.auth=t}return t.prototype.canActivate=function(t,e){return this.auth.isLoggedIn?i.Observable.of(!0):i.Observable.of(!1)},t=__decorate([o.Injectable(),__metadata("design:paramtypes",[c.AuthService])],t)}();e.CanActivateProfile=l,e.routes=[{path:"",component:s.HomeComponent},{path:"about",component:a.AboutComponent},{path:"profile",component:u.ProfileComponent,canActivate:[l]}],e.APP_ROUTER_PROVIDERS=[l,n.provideRouter(e.routes)]},414:function(t,e,r){"use strict";var n=r(34),o=r(383);n.Observable.of=o.of},415:function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}n(r(416))},416:function(t,e,r){"use strict";var n=r(1),o=r(34);r(414);var i=r(403),s=function(){function t(t){this.api=t,this.message={message:""}}return t.prototype.onPingClick=function(){this.handleRequest(this.api.ping())},t.prototype.onSecurePingClick=function(){this.handleRequest(this.api.securePing())},t.prototype.onOwnerPingClick=function(){this.handleRequest(this.api.ownerOnlyPing())},t.prototype.ngOnInit=function(){console.log("Hello Home")},t.prototype.ngOnDestroy=function(){this.sub&&this.sub.unsubscribe()},t.prototype.handleRequest=function(t){var e=this;this.sub&&!this.sub.isUnsubscribed&&this.sub.unsubscribe(),this.sub=t["catch"](function(t){return console.error(t),o.Observable.of({message:"error occured - "+(t.status?t.status:t)+" "+(t.statusText?t.statusText:"")})}).subscribe(function(t){e.message=t.json?t.json():t})},t=__decorate([n.Component({selector:"my-home",template:r(417),styles:[r(418)]}),__metadata("design:paramtypes",[i.ApiService])],t)}();e.HomeComponent=s},417:function(t,e){t.exports='<p>\n  Home Works!\n</p>\n\n<div>\n  <button type="button" (click)="onPingClick()">Ping</button>\n  <button type="button" (click)=onSecurePingClick()>Secure Ping</button>\n  <button type="button" (click)=onOwnerPingClick()>Owner-only Ping</button>\n</div>\n<p *ngIf="message?.message.length > 0">{{ message | json }}</p>\n'},418:function(t,e){t.exports="p{color:#FFEF00}\n"},419:function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}n(r(420))},420:function(t,e,r){"use strict";var n=r(1),o=function(){function t(){}return t.prototype.ngOnInit=function(){console.log("Hello About")},t=__decorate([n.Component({selector:"my-about",template:r(421),styles:[r(422)]}),__metadata("design:paramtypes",[])],t)}();e.AboutComponent=o},421:function(t,e){t.exports="<p>\r\n  About Works!\r\n</p>\r\n"},422:function(t,e){t.exports="*{color:#f87c08}\n"},423:function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}n(r(424))},424:function(t,e,r){"use strict";var n=r(1),o=r(34);r(414),r(425);var i=r(403),s=function(){function t(t){this.api=t}return t.prototype.ngOnInit=function(){this.getUserData()},t.prototype.getUserData=function(){this.profile$=this.api.getUserData()["catch"](function(t){return console.error(t),o.Observable.of({claims:[{type:"error occured",value:"("+t.status+" "+t.statusText+")"}]})}).map(function(t){return t.json?t.json():t})},t=__decorate([n.Component({selector:"my-profile",template:r(427),styles:["\n    table {\n      width: 90%;\n      text-align: start;\n    }\n    table th {\n      font-weight: bold;\n      border-bottom: 1px dotted white;\n    }\n  "]}),__metadata("design:paramtypes",[i.ApiService])],t)}();e.ProfileComponent=s},425:function(t,e,r){"use strict";var n=r(34),o=r(426);n.Observable.prototype["catch"]=o._catch},426:function(t,e,r){"use strict";function n(t){var e=new s(t),r=this.lift(e);return e.caught=r}var o=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=r(39);e._catch=n;var s=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e._subscribe(new a(t,this.selector,this.caught))},t}(),a=function(t){function e(e,r,n){t.call(this,e),this.selector=r,this.caught=n}return o(e,t),e.prototype.error=function(t){if(!this.isStopped){var e=void 0;try{e=this.selector(t,this.caught)}catch(t){return void this.destination.error(t)}this._innerSub(e)}},e.prototype._innerSub=function(t){this.unsubscribe(),this.destination.remove(this),t.subscribe(this.destination)},e}(i.Subscriber)},427:function(t,e){t.exports='<p>\r\n  User profile\r\n</p>\r\n\r\n<table>\r\n  <tr>\r\n    <th>Claim type</th>\r\n    <th>Claim value</th>\r\n  </tr>\r\n  <tr *ngFor="let claim of (profile$ | async)?.claims">\r\n    <td>{{ claim.type }}</td>\r\n    <td>{{ claim.value }}</td>\r\n  </tr>\r\n</table>'}});
//# sourceMappingURL=app.js.map